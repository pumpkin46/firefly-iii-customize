/*
 * bootstrap-tagsinput v0.9.1
 *
 */

!function(a){"use strict";function b(b,c){this.isInit=!0,this.itemsArray=[],this.$element=a(b),this.$element.hide(),this.isSelect="SELECT"===b.tagName,this.multiple=this.isSelect&&b.hasAttribute("multiple"),this.objectItems=c&&c.itemValue,this.placeholderText=b.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=a('<div class="bootstrap-tagsinput"></div>'),this.$input=a('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(c),this.isInit=!1}function c(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(a){return a[c]}}}function d(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(){return c}}}function e(a){return a?j.text(a).html():""}function f(a){return String(a).replace(/[&<>"'\/\\]/g,function(a){return k[a]})}function g(a){var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart);return b}function h(b,c){return-1!==a.inArray(b.key,c)}var i={tagClass:function(a){return"label label-info"},focusClass:"focus",itemValue:function(a){return a?a.toString():a},itemText:function(a){return this.itemValue(a)},itemTitle:function(a){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:["Enter",","],confirmOnPaste:!1,deleteKeys:["Backspace","Delete"],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(a,b){b.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,triggerChange:!0,caseSensitive:!0};b.prototype={constructor:b,add:function(b,c,d){var g=this;if(!(g.options.maxTags&&g.itemsArray.length>=g.options.maxTags)&&(!1===b||b)){if("string"==typeof b&&g.options.trimValue&&(b=a.trim(b)),"object"==typeof b&&!g.objectItems)throw"Can't add objects when itemValue option is not set";if(!b.toString().match(/^\s*$/)){if(g.isSelect&&!g.multiple&&g.itemsArray.length>0&&g.remove(g.itemsArray[0]),"string"==typeof b&&"INPUT"===this.$element[0].tagName){var h=g.options.delimiterRegex?g.options.delimiterRegex:g.options.delimiter,i=b.split(h);if(i.length>1){for(var j=0;j<i.length;j++)this.add(i[j],!0);return void(c||g.pushVal(g.options.triggerChange))}}var k=g.options.itemValue(b),l=g.options.itemText(b),m=g.options.tagClass(b),n=g.options.itemTitle(b),o=a.grep(g.itemsArray,function(a){return g.options.caseSensitive?g.options.itemValue(a)===k:g.options.itemValue(a).toLowerCase()===k.toLowerCase()})[0];if(!o||g.options.allowDuplicates){if(!(g.items().toString().length+b.length+1>g.options.maxInputLength)){var p=a.Event("beforeItemAdd",{item:b,cancel:!1,options:d});if(g.$element.trigger(p),!p.cancel){g.itemsArray.push(b);var q=a('<span class="tag '+e(m)+(null!==n?'" title="'+n:"")+'">'+e(l)+'<span data-role="remove"></span></span>');q.data("item",b),g.findInputWrapper().before(q),q.after(" ");var r=f(k),s=a('option[value="'+encodeURIComponent(k)+'"]',g.$element).length||a('option[value="'+e(r)+'"]',g.$element).length;if(g.isSelect&&!s){var t=a("<option selected>"+e(l)+"</option>");t.data("item",b),t.attr("value",r),g.$element.append(t)}c||g.pushVal(g.options.triggerChange),g.options.maxTags!==g.itemsArray.length&&g.items().toString().length!==g.options.maxInputLength||g.$container.addClass("bootstrap-tagsinput-max"),a(".typeahead, .twitter-typeahead",g.$container).length&&g.$input.typeahead("val",""),this.isInit?g.$element.trigger(a.Event("itemAddedOnInit",{item:b,options:d})):g.$element.trigger(a.Event("itemAdded",{item:b,options:d}))}}}else if(g.options.onTagExists){var u=a(".tag",g.$container).filter(function(){return a(this).data("item")===o});g.options.onTagExists(b,u)}}}},remove:function(b,c,d){var e=this;if(e.objectItems&&(b="object"==typeof b?a.grep(e.itemsArray,function(a){return e.options.itemValue(a)==e.options.itemValue(b)}):a.grep(e.itemsArray,function(a){return e.options.itemValue(a)==b}),b=b[b.length-1]),b){var f=a.Event("beforeItemRemove",{item:b,cancel:!1,options:d});if(e.$element.trigger(f),f.cancel)return;a(".tag",e.$container).filter(function(){return a(this).data("item")===b}).remove(),a("option",e.$element).filter(function(){return a(this).data("item")===b}).remove(),-1!==a.inArray(b,e.itemsArray)&&e.itemsArray.splice(a.inArray(b,e.itemsArray),1)}c||e.pushVal(e.options.triggerChange),e.options.maxTags>e.itemsArray.length&&e.$container.removeClass("bootstrap-tagsinput-max"),e.$element.trigger(a.Event("itemRemoved",{item:b,options:d}))},removeAll:function(){var b=this;for(a(".tag",b.$container).remove(),a("option",b.$element).remove();b.itemsArray.length>0;)b.itemsArray.pop();b.pushVal(b.options.triggerChange)},refresh:function(){var b=this;a(".tag",b.$container).each(function(){var c=a(this),d=c.data("item"),f=b.options.itemValue(d),g=b.options.itemText(d),h=b.options.tagClass(d);if(c.attr("class",null),c.addClass("tag "+e(h)),c.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=e(g),b.isSelect){a("option",b.$element).filter(function(){return a(this).data("item")===d}).attr("value",f)}})},items:function(){return this.itemsArray},pushVal:function(){var b=this,c=a.map(b.items(),function(a){return b.options.itemValue(a).toString()});b.$element.val(c,!0),b.options.triggerChange&&b.$element.trigger("change")},build:function(b){var e=this;if(e.options=a.extend({},i,b),e.objectItems&&(e.options.freeInput=!1),c(e.options,"itemValue"),c(e.options,"itemText"),d(e.options,"tagClass"),e.options.typeahead){var f=e.options.typeahead||{};d(f,"source"),e.$input.typeahead(a.extend({},f,{source:function(b,c){function d(b){b&&(a.isFunction(b.success)?b.success(c):a.isFunction(b.then)?b.then(c):a.when(b).then(c))}a.isFunction(f.source)&&3===f.source.length?f.source(b,d,d):d(f.source(b))},updater:function(a){return e.objectItems?e.add(e.options.itemValue(a)):e.add(e.options.itemText(a)),""}}))}if(e.options.typeaheadjs){var j=[e.options.typeaheadjs],k=[null,j];if(a.isArray(e.options.typeaheadjs)){var l=e.options.typeaheadjs[0];j=a.isArray(e.options.typeaheadjs[1])?l[1]:[].slice.call(e.options.typeaheadjs,1),k=[l,j]}a.fn.typeahead.apply(e.$input,k).on("typeahead:selected",a.proxy(function(a,b,c){var d=0;j.some(function(a,b){return a.name===c&&(d=b,!0)}),j[d].valueKey?e.add(b[j[d].valueKey]):e.add(b),e.$input.typeahead("val","")},e))}e.$container.on("click",a.proxy(function(a){e.$element.attr("disabled")||e.$input.removeAttr("disabled"),e.$input.focus()},e)),e.options.addOnBlur&&e.options.freeInput&&e.$input.on("focusout",a.proxy(function(b){0===a(".typeahead, .twitter-typeahead",e.$container).length&&(e.add(e.$input.val()),e.$input.val(""))},e)),e.$container.on({focusin:function(){e.$container.addClass(e.options.focusClass)},focusout:function(){e.$container.removeClass(e.options.focusClass);var a=e.findInputWrapper();a.siblings().last().after(a)}}),e.$container.on("keydown input","input",a.proxy(function(b){var c=a(b.target),d=e.findInputWrapper();if(e.$element.attr("disabled"))return void e.$input.attr("disabled","disabled");switch(b.key){case"Backspace":if(e.options.deleteKeys&&h(b,e.options.deleteKeys)>-1&&0===g(c[0])){var f=d.prev();f.length&&e.remove(f.data("item"))}break;case"Delete":if(e.options.deleteKeys&&h(b,e.options.deleteKeys)>-1&&0===g(c[0])){var i=d.next();i.length&&e.remove(i.data("item"))}break;case"ArrowLeft":var j=d.prev();0===c.val().length&&j[0]&&(j.before(d),c.focus());break;case"ArrowRight":var k=d.next();0===c.val().length&&k[0]&&(k.after(d),c.focus());break;case"Home":var l=d.siblings().first();0===c.val().length&&l[0]&&(l.before(d),c.focus());break;case"End":var m=d.siblings().last();0===c.val().length&&m[0]&&(m.after(d),c.focus())}var n=c.val().length;Math.ceil(n/5);c.attr("size",Math.max(this.inputSize,c.val().length))},e)),e.$container.on("keypress input","input",a.proxy(function(b){var c=a(b.target);if(e.$element.attr("disabled"))return void e.$input.attr("disabled","disabled");var d=c.val(),f=e.options.maxChars&&d.length>=e.options.maxChars;e.options.freeInput&&(h(b,e.options.confirmKeys)||e.options.confirmOnPaste&&"input"===b.originalEvent.type||f)&&(0!==d.length&&(e.add(f?d.substr(0,e.options.maxChars):d),c.val(""),b.preventDefault()),!1!==e.options.cancelConfirmKeysOnEmpty&&b.preventDefault());var g=c.val().length;Math.ceil(g/5);c.attr("size",Math.max(this.inputSize,c.val().length))},e)),e.$container.on("click","[data-role=remove]",a.proxy(function(b){e.$element.attr("disabled")||e.remove(a(b.target).closest(".tag").data("item"))},e)),e.options.itemValue===i.itemValue&&("INPUT"===e.$element[0].tagName?e.add(e.$element.val()):a("option",e.$element).each(function(){e.add(a(this).attr("value"),!0)}))},destroy:function(){var a=this;a.$container.off("keypress","input"),a.$container.off("click","[role=remove]"),a.$container.remove(),a.$element.removeData("tagsinput"),a.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var b=this.$input[0],c=this.$container[0];b&&b.parentNode!==c;)b=b.parentNode;return a(b)}},a.fn.tagsinput=function(c,d,e){var f=[];return this.each(function(){var g=a(this).data("tagsinput");if(g)if(c||d){if(void 0!==g[c]){if(3===g[c].length&&void 0!==e)var h=g[c](d,null,e);else var h=g[c](d);void 0!==h&&f.push(h)}}else f.push(g);else g=new b(this,c),a(this).data("tagsinput",g),f.push(g),"SELECT"===this.tagName&&a("option",a(this)).attr("selected","selected"),a(this).val(a(this).val())}),"string"==typeof c?f.length>1?f:f[0]:f},a.fn.tagsinput.Constructor=b;var j=a("<div />"),k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","\\":"&#x5C"};a(function(){a("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery);
//# sourceMappingURL=bootstrap-tagsinput.min.js.map